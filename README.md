# ChatSF

This is a chat program that uses OpenAI's GPT to answer a user's questions about the data in a Salesforce CRM system.  As configured, it is focused on a very small subset of sales related SObjects (aka Tables), but it can be configured to work with any objects in Salesforce that you choose.

## Requirements

In order to run the code, you'll need to have a recent version of Python installed; I suggest a 3.11 (or later).  If you do not have Python installed, you might want to install [Anaconda](https://www.anaconda.com/download) or its more demure sibling, [Miniconda](https://docs.conda.io/projects/miniconda/en/latest/).  I might also suggest a good Python IDE like  [PyCharm](https://www.jetbrains.com/products/compare/?product=pycharm&product=pycharm-ce), which comes free with Anaconda.  You do not need an IDE for this project, but it is most helpful, although at the cost of having to learn the IDE.

## Installation

These instructions assume you are doing everything from the command line.  If you are using an IDE, of course, it will have its own means for achieving the same results.

The first step is to clone this repository.

 In a directory you use to hold projects, issue the command

```bash
git clone https://github.com/cmcguinness/ChatSF
```

When that's done, change directory into the ChatSF directory.

```bash
cd ChatSF
```

The last step is to install the dependencies with the following command:

```bash
pip install -r requirements.txt
```

At this point, you've installed the application and its dependencies.

## Configuration

To configure the application, you have to set several environment variables. Four of them come from Salesforce, and one from OpenAI.  There's also optional variables for controlling log file generation.

### Salesforce Environment Variables

You'll need a Salesforce login and to create a consumer key and secret for the application.  The process is a bit convoluted, so I've documented it a web page entitled: [Getting a Salesforce Consumer Key and Secret](https://open.substack.com/pub/mcguinnessai/p/getting-a-salesforce-consumer-key?r=bsie&utm_campaign=post&utm_medium=web).  In the end, you'll need with four parameters: your  username and password (which, presumably, you already know), and the consumer key and secret that you extract from Salesforce.

### OpenAI Environment Variables

There's one environment variable you need, an OpenAI API Key.  If you've not set up an account with OpenAI yet for API access, follow the instructions in my page [Getting Started with OpenAI](https://open.substack.com/pub/mcguinnessai/p/getting-started-with-openai?r=bsie&utm_campaign=post&utm_medium=web).

### Optional Logging Variables

```bash
LOG_LEVEL=None, Error, Warning, Info, or Debug
LOG_FILE=1
```

Set neither, either, or both of these to affect the logging output generated by the program.  

LOG_LEVEL controls how much detail you get from the logging output.  It defaults to Debug.

LOG_FILE controls whether the output goes to the console (aka Terminal or stdout) or to a timestamped file (if LOG_FILE is set).  Default is to the console.

### How to Manage Environment Variables

The easiest way to do this is to create a file called `.env` in the root directory 
of the project and put the following lines in it:

```bash
export SF_USERNAME=your_sf_username
export SF_PASSWORD=your_sf_password
export SF_KEY=your_sf_security_token
export SF_SECRET=your_sf_consumer_secret
export OPENAI_API_KEY=your_openai_api_key
```

Then, to load these into your environment, you can run the following command:

```bash
source .env
```
or

```bash
. .env
```

## Test runner

There's a simplistic test runner in the application; at the bottom
of chatsf.py you can see the line:

```
bot.autobot(test_suite, True)
```

This runs through each of the user inputs in the list test_suite. The second parameter,
(in this case, `True`) tells whether you want to have the user text output in a sort of
similuation of a fast typer.

## Running the program

There's nothing special to do this, just `python3 chatsf.py`


